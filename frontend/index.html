<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>新冠肺炎实时疫情</title>
	<link rel="stylesheet" type="text/css" href="static/css/main.css" />
	<link rel="stylesheet" type="text/css" href="static/css/index.css" />
	<script type="text/javascript" src="static/js/index.js"></script>
	<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
</head>
<body>
	<div id="header">
			<h1 style="display:inline;margin:5px 10px">新冠肺炎疫情情况</h1>
			<input type="date" id="nowDateTime"/>
			<div id="pageJump">
				<p id="pageJumpFont" style="margin:36px 10px 5px 159px"><a href="news.html">最新资讯</a></p>
				<img src="static/img/moveIcon.png"  style="margin:20px 0px -13px 0px"/>
			</div>
	</div>
	
	<div id="wrap">
		<div id="content">
		
			<div class="escMesage">
				<ul class="showEsc">
					<li class="esc">当前确诊</li>
					<li id="ip">0</li>
					<li id="addIp">0</li>
				</ul>
				<ul class="showEsc">
					<li class="esc">累计确诊</li>
					<li id="sumIp">0</li>
					<li id="addSumIp">0</li>
				</ul>
				<ul class="showEsc">
					<li class="esc">现有疑似</li>
					<li id="sp">0</li>
					<li id="addSp">0</li>
				</ul>
				<ul class="showEsc">
					<li class="esc">累计治愈</li>
					<li id="cure">0</li>
					<li id="addCure">0</li>
				</ul>
				<ul class="showEsc">
					<li class="esc">累计死亡</li>
					<li id="dead">0</li>
					<li id="addDead">0</li>
				</ul>
				<p style="clear:both"></p>
			</div>
			
			<div class="showMapButtonSet">
				<button class="showMapButton" id="nationalwideIp">全国当前确诊情况
				</button><button class="showMapButton" id="nationalwideSumIp">全国累计确诊情况</button>
			</div>
			
			<div>
				<iframe src="map-polygon.html" frameBorder="0" width="800" scrolling="no" height="900"></iframe>
			</div>
			
			<div class="escMesage" style="width:775px">
				<button class="trandChartButton" style="background-color:red">全国疫情新增趋势
				</button><button class="trandChartButton">全国累计确诊疑似
				</button><button class="trandChartButton">全国累计治愈死亡
				</button><button class="trandChartButton">治愈与死亡率</button>
			</div>
			
			<div id="trendChart" style="width:775px;height:700px">
			</div>
		</div>
	</div>
	
	<script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('trendChart'));


        function update_china_data(data) {
			$('#ip').text(data.nowConfirm)
			$('#addIp').text(data.newNowConfirm)
			$('#sumIp').text(data.confirmed)
			$('#addSumIp').text(data.newConfirmed);
			$('#sp').text(data.unconfirmed);
			$('#addSp').text(data.newUnconfirmed);
			$('#cure').text(data.cured);
			$('#addCure').text(data.newCured);
			$('#dead').text(data.died);
			$('#addDead').text(data.newDied);
		}
		
		function update_china_map(data) {

		}
		
		function update_china_trend(data) {

		}

		function update_all_data(){
			$.get('/api/index', function (data, status) {
				if (status !== 'success'){
					alert('获取数据失败')
				} else {
					data = JSON.parse(data)
					update_china_data(data.china_data)
					update_china_map(data.province_data)
					update_china_trend(data.china_trend_data)
				}
			})
		}


		$(document).ready(function(){
			update_all_data();
		})

        // 指定图表的配置项和数据
        let option = {
            title: {},
            tooltip: {
				trigger: 'axis',
				axisPointer: {
					type: 'cross'
				}
			},
            legend: {},
            xAxis: {
                data: ["1-26","1-27","1-28","1-29","1-30","1-31","2-1","2-2","2-3","2-4","2-5","2-6","2-7","2-8","2-9"]
            },
            yAxis: [{
				type: 'value',
				name:'单位：例',
			}],
            series: [{
				name: '新增确诊',
                type: 'line',
				smooth: 'true',
                data: [5, 20, 36, 10, 10, 20, 20, 36, 10, 10, 20, 20, 36, 10, 10]
            }]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
</body>
</html>
